I"q\<h1 class="no_toc" id="asset-transfers">Asset Transfers</h1>

<p>An asset transfer is an asynchronous exchange of an asset or an amount to a recipient.</p>

<p>A recipient is an existing Centrapay user or someone who can create an account to claim the asset transfer by verifying
their phone number.</p>

<p>After an asset transfer is completed the recipientAlias, lastSentTo and
message fields are scrubbed to avoid storing PII.</p>

<h2 class="no_toc text-delta" id="contents">Contents</h2>

<ul id="markdown-toc">
  <li><a href="#asset-transfer-lifecycle" id="markdown-toc-asset-transfer-lifecycle">Asset Transfer lifecycle</a></li>
  <li><a href="#create-an-asset-transfer" id="markdown-toc-create-an-asset-transfer">Create an Asset Transfer</a></li>
  <li><a href="#get-an-asset-transfer" id="markdown-toc-get-an-asset-transfer">Get an Asset Transfer</a></li>
  <li><a href="#get-an-asset-transfer-public-summary" id="markdown-toc-get-an-asset-transfer-public-summary">Get an Asset Transfer Public Summary</a></li>
  <li><a href="#resolve-claimable-assets-experimental" id="markdown-toc-resolve-claimable-assets-experimental">Resolve claimable assets <strong>EXPERIMENTAL</strong></a></li>
  <li><a href="#list-asset-transfers-experimental" id="markdown-toc-list-asset-transfers-experimental">List Asset Transfers <strong>EXPERIMENTAL</strong></a></li>
</ul>

<h2 id="asset-transfer-lifecycle">Asset Transfer lifecycle</h2>

<p>Asset Transfer goes through different lifecycle stages.</p>

<p><img src="/images/asset-lifecycle.png" style="display: block; margin: auto;" /></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">State</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">created</td>
      <td style="text-align: left">Asset transfer successfully created</td>
    </tr>
    <tr>
      <td style="text-align: left">sent</td>
      <td style="text-align: left">Asset transfer notification (sms, email) was sent to a new user</td>
    </tr>
    <tr>
      <td style="text-align: left">expired</td>
      <td style="text-align: left">Asset transfer expired as new user didn’t create his account and claimed the asset. This is very short lived state</td>
    </tr>
    <tr>
      <td style="text-align: left">returned</td>
      <td style="text-align: left">Asset transfer expired and was returned to original owner</td>
    </tr>
    <tr>
      <td style="text-align: left">claimed</td>
      <td style="text-align: left">Asset transfer was successfully completed</td>
    </tr>
  </tbody>
</table>

<p><a name="asset-transfer-create"></a></p>
<h2 id="create-an-asset-transfer">Create an Asset Transfer</h2>

<p>Transfer an asset to a recipient. Some assets can be transfered only in whole
(eg giftcards or tokens) while others can be transfered only in part (eg money).</p>

<p>
        POST <code>/<wbr />api/<wbr />asset-transfers</code>
        
        
        
        <h4>Whole asset transfer</h4>
      
        
        <div class="highlighter-rouge">
          <pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/api/asset-transfers <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
    "assetId": "YGRo6TYYSxH3js7",
    "recipientAlias": "+642212312"
  }'</span></code></pre>
        </div>
      
      

        
        <h4>Partial asset transfer</h4>
      
        
        <div class="highlighter-rouge">
          <pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/api/asset-transfers <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
    "assetId": "sai2Pai7ohgongo",
    "value": "6000",
    "recipientAlias": "+642212312"
  }'</span></code></pre>
        </div>
      
      
      </p>

<h4>Required Fields </h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parameter</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">assetId</td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">Id of a discrete asset to transfer or wallet to draw from.</td>
    </tr>
    <tr>
      <td style="text-align: left">recipientAlias</td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">Phone number, email or handle of receiver.</td>
    </tr>
  </tbody>
</table>

<h4>Optional Parameters </h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parameter</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">description</td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">Shows up in transaction history against the transfer. 200  character limit.</td>
    </tr>
    <tr>
      <td style="text-align: left">message</td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">A message which shows up in the SMS of the receiver. 100  character limit.</td>
    </tr>
    <tr>
      <td style="text-align: left">value</td>
      <td style="text-align: left"><a href="/api/data-types#bignumber ">BigNumber </a></td>
      <td style="text-align: left">Amount to send. Required for money transfers. Units depend on the asset type.</td>
    </tr>
    <tr>
      <td style="text-align: left">senderName</td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">Human readable name for the sender. 30  character limit.</td>
    </tr>
    <tr>
      <td style="text-align: left">suppressNotifications</td>
      <td style="text-align: left">Boolean</td>
      <td style="text-align: left">Suppress notifications from Centrapay (SMS/Email).</td>
    </tr>
  </tbody>
</table>

<h4>Example response payload </h4>

<p>
        <div class="highlighter-rouge">
          <pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M7Kn2stAxNa6ri7h"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YGRo6TYYSxH3js7"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assetType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"epay.nzd.main"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$60 Giftcard"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Happy birthday"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"senderName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Cafe"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"recipientAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9EDxUT91TMsUjoqoQeBuLQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"claimedByAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9EDxUT91TMsUjoqoQeBuLQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"recipientAlias"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+64212312345"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-01T12:30:00.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-02T01:03:37.222Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"suppressNotifications"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
        </div>
      </p>

<p>The above example has $10 left on a $60 dollar giftcard at the time of transfer.</p>

<h4>Error Responses </h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Status</th>
      <th style="text-align: left">Code</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">403</td>
      <td style="text-align: left">INSUFFICIENT_<wbr />WALLET_<wbr />BALANCE</td>
      <td style="text-align: left">The value of the asset-transfer exceeds the balance on the wallet</td>
    </tr>
    <tr>
      <td style="text-align: left">403</td>
      <td style="text-align: left">QUOTA_<wbr />EXCEEDED</td>
      <td style="text-align: left">The transfer exceeds one or more spend quota limits. See <a href="/api/quotas#quota-error-response">Quota Error Response</a>.</td>
    </tr>
    <tr>
      <td style="text-align: left">403</td>
      <td style="text-align: left">ASSET_<wbr />NOT_<wbr />ACTIVE</td>
      <td style="text-align: left">The asset is not active and cannot be transferred.</td>
    </tr>
  </tbody>
</table>

<h2 id="get-an-asset-transfer">Get an Asset Transfer</h2>

<p>
        GET <code>/<wbr />api/<wbr />asset-transfers/<wbr />{assetTransferId}</code>
        
        
        <h4></h4>
      
        
        <div class="highlighter-rouge">
          <pre class="highlight"><code>curl https://service.centrapay.com/api/asset-transfers/M7Kn2stAxNa6ri7h <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span></code></pre>
        </div>
      
      
        
      </p>

<h4>Example response payload (In-progress money transfer) </h4>

<p>
        <div class="highlighter-rouge">
          <pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M7Kn2stAxNa6ri7h"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sent"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6000"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sai2Pai7ohgongo"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assetType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"centrapay.nzd.main"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Happy birthday"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"senderName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Cafe"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"lastSentTo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+64212312345"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"senderAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aBc932S9182qwCDqwer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"recipientAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"oS3Xom2au3Ooy9aihai"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"claimedByAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9EDxUT91TMsUjoqoQeBuLQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"recipientAlias"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+64212312345"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-01T12:30:00.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-02T01:03:37.222Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"suppressNotifications"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
        </div>
      </p>

<h4>Example response payload (completed giftcard transfer) </h4>

<p>
        <div class="highlighter-rouge">
          <pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M7Kn2stAxNa6ri7h"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"claimed"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6000"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YGRo6TYYSxH3js7"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assetType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"epay.nzd.main"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$60 Giftcard"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Happy birthday"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"senderName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Cafe"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"recipientAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9EDxUT91TMsUjoqoQeBuLQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"claimedByAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9EDxUT91TMsUjoqoQeBuLQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"recipientAlias"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+64******2345"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-01T12:30:00.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-02T01:03:37.222Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"suppressNotifications"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
        </div>
      </p>

<h2 id="get-an-asset-transfer-public-summary">Get an Asset Transfer Public Summary</h2>

<p>
        GET <code>/<wbr />api/<wbr />asset-transfers/<wbr />{assetTransferId}/<wbr />public-summary</code>
        
        
        <h4></h4>
      
        
        <div class="highlighter-rouge">
          <pre class="highlight"><code>curl https://service.centrapay.com/api/asset-transfers/M7Kn2stAxNa6ri7h/public-summary</code></pre>
        </div>
      
      
        
      </p>

<h4>Example response payload </h4>

<p>
        <div class="highlighter-rouge">
          <pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M7Kn2stAxNa6ri7h"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YGRo6TYYSxH3js7"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Happy birthday"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"senderName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Cafe"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-01T12:30:00.000Z"</span><span class="w">
</span><span class="p">}</span></code></pre>
        </div>
      </p>

<h2 id="resolve-claimable-assets-experimental">Resolve claimable assets <strong>EXPERIMENTAL</strong></h2>

<p>When you send another centrapay user cash or assets, they’re automatically assigned to them.
However, if they’re not signed up yet then these assets are not immediately assigned.</p>

<p>If unclaimed, asset transfers are returned after 2 weeks.</p>

<p>New accounts should call this endpoint to allocate assets that you’ve been sent.</p>

<p>
        POST <code>/<wbr />api/<wbr />me/<wbr />resolve-claimable-assets</code>
        
        
        <h4></h4>
      
        
        <div class="highlighter-rouge">
          <pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/api/me/resolve-claimable-assets <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span></code></pre>
        </div>
      
      
        
      </p>

<h4>Example response payload </h4>

<p>
        <div class="highlighter-rouge">
          <pre class="highlight"><code><span class="p">{</span><span class="w">
</span><span class="p">}</span></code></pre>
        </div>
      </p>

<h2 id="list-asset-transfers-experimental">List Asset Transfers <strong>EXPERIMENTAL</strong></h2>

<p>Returns a <a href="/api/pagination">paginated</a> list of Asset Transfers.</p>

<p>
        GET <code>/<wbr />api/<wbr />asset-transfers</code>
        
        
        
        <h4>List asset transfers received</h4>
      
        
        <div class="highlighter-rouge">
          <pre class="highlight"><code>curl <span class="nt">-G</span> https://service.centrapay.com/api/asset-transfers <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">recipientAccountId</span><span class="o">=</span>oS3Xom2au3Ooy9aihai</code></pre>
        </div>
      
      

        
        <h4>List asset transfers sent</h4>
      
        
        <div class="highlighter-rouge">
          <pre class="highlight"><code>curl <span class="nt">-G</span> https://service.centrapay.com/api/asset-transfers <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">senderAccountId</span><span class="o">=</span>aBc932S9182qwCDqwer</code></pre>
        </div>
      
      
      </p>

<h4>Example response payload </h4>

<p>
        <div class="highlighter-rouge">
          <pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M7Kn2stAxNa6ri7h"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6000"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"assetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YGRo6TYYSxH3js7"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$60 Giftcard"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Happy birthday"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"senderName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Cafe"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"senderAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aBc932S9182qwCDqwer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recipientAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9EDxUT91TMsUjoqoQeBuLQ"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"claimedByAccountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9EDxUT91TMsUjoqoQeBuLQ"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recipientAlias"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+64*****2345"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-01T12:30:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-02T01:03:37.222Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"suppressNotifications"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre>
        </div>
      </p>

:ET