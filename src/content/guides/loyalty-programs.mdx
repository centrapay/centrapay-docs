---
title: Loyalty Programs
description: Complete promotions and earn points with Centrapay.
nav:
  path: Reference/Digital Assets
  order: 5
---

import CodePanel from '../../components/CodePanel.astro';

## Overview

A Loyalty Program is a collection of Promotions that reward accounts for completing certain actions. For example, a Loyalty Program could be set up to reward accounts with points every time they make a payment.

To set up a loyalty program and issue rewards, there are a few required steps:

``` mermaid
sequenceDiagram
	autonumber

	Loyalty Program Provider->>Centrapay: Create Loyalty Program
	Loyalty Program Provider->>Centrapay: Create Promotion(s)
	Loyalty Program Provider->>Centrapay: Create Account
	Loyalty Program Provider->>Centrapay: Create Loyalty Program Membership for Account

	opt
	Loyalty Program Provider->>Centrapay: Create Events
	end

	opt
	Loyalty Program Provider->>Centrapay: List Promotion Memberships for Account
	end
```

1. [Create Loyalty Program](/api/loyalty-programs/#create-loyalty-program)
    - A Loyalty Program is a container for the Promotions that will be created in step 2.
2. [Create Promotion(s)](/api/promotions/#create-promotion)
    - Promotions contain conditions, a target, and a reward.
3. [Create Account](/api/accounts/#create-an-account)
    - This will be the account that will participate in the Loyalty Program.
4. [Create Loyalty Program Membership for Account](/api/loyalty-program-memberships/#create-loyalty-program-memberships)
    - This will onboard the Account to the Loyalty Program. A Promotion Membership will be created for each Promotion under the Loyalty Program.
    - Promotion Memberships contain the progress for the Account towards completing certain Promotions.
5. [Create Events](/api/events/#create-event)
    - When accounts perform actions, Events are generated that are used to increment progress on their Promotions. If you'd like to send us Events from your own application, you can define them here.
6. [List Promotion Memberships for Account](/api/promotion-memberships/#list-promotion-memberships-by-account)
    - This will return the account's Promotion Memberships along with their current progress and whether they have been completed or not.

## Events

Events are records of account actions and can be created by Centrapay internal systems, as well as external systems by calling the [Create Event API](https://docs.centrapay.com/api/events/#create-event).

When an Event is generated for an Account, Centrapay will look up all the Promotion Memberships under that account and check the conditions for each one. If the event satisfies the conditions, the Promotion progress will be incremented.

<CodePanel title="Example Event">
```json
{
  "id": "L75M3L56N2PtBSt8g7uXLU",
  "accountId": "Jaim1Cu1Q55uooxSens6yk",
  "type": "payment-request:paid",
  "data": {
    "paymentAmount": "1000"
  },
  "idempotencyKey": "login-de32dd90-b46c-11ea-93c3-83a333b86e7b",
  "createdAt": "2020-05-01T12:30:00.000Z",
  "createdBy": "crn:WIj211vFs9cNACwBb04vQw:api-key:MyApiKey"
}
```
</CodePanel>

## Creating Promotions
There are many configurations that need to be kept in mind when creating Promotions.

### eventType

`eventType` must match the `type` on the Event that will cause the Promotion Membership to be incremented.

There are some native Events types that Centrapay generates that you can use. They can be found [here](/api/centrapay-event-types/).

You should NOT send us Events with a `type` that matches any of those in the linked page above. You CAN create Promotions with those Event types if you wish to reward accounts for native Centrapay events.

### Conditions

Conditions are used to define certain values an Event needs to have in order to progress the Promotion. Promotions can have zero or more conditions defined. Every condition must be satisfied by an Event before the Promotion Membership progress can be incremented.

Each condition has a `field` property that references the field we're checking on the `data` object in the Event. The `operator` and `value` properties complete the condition, e.g. “greater-than” “5”.

### Target

The “target” of the Promotion dictates how the progress of the Promotion Membership gets incremented, and how much progress is needed to complete the Promotion Membership.

### Rewards

This defines the rewards that the account will receive upon completing the Promotion Membership. The account will receive ALL the rewards defined on the Promotion.
