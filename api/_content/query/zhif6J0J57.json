[{"_path":"/guides/initiating-refunds","_dir":"guides","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Initiating Refunds","description":"Refunds are initiated by calling the Refund Payment Request endpoint.","excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Refunds are initiated by calling the "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#refund-a-payment-request-experimental","rel":["nofollow"]},"children":[{"type":"text","value":"Refund Payment Request"}]},{"type":"text","value":" endpoint."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Refunds can be partial or full. Partial refunds can be performed multiple times but the total refunded amount cannot exceed the paid amount."}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"refund-idempotency"},"children":[{"type":"text","value":"Refund Idempotency"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Refund requests must provide an "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"externalRef"}]},{"type":"text","value":" that is unique for all refunds made against the "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"Payment Request"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This field provides idempotency for the refund operation and ensures that a refund can be retried safely and only one refund will be actioned. Subsequent refund requests with the same "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"amount"}]},{"type":"text","value":" and "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"externalRef"}]},{"type":"text","value":" will respond with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"HTTP 200 OK"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"obtaining-a-payment-request-id"},"children":[{"type":"text","value":"Obtaining a Payment Request Id"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Refunds are initiated using the identifier for the "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"Payment Request"}]},{"type":"text","value":". However, a patron is NOT expected to have this information available."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Merchants can obtain a Payment Request identifier by looking the Payment Request up by "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"shortCode"}]},{"type":"text","value":" or by using some other transaction reference available to the patron."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Digital wallets that support transacting with Centrapay will always make the Payment Request "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"shortCode"}]},{"type":"text","value":" and "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"externalRef"}]},{"type":"text","value":" attributes discoverable in the user’s transaction history so they can be used to negotiate refunds."}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h3","props":{"id":"by-short-code"},"children":[{"type":"text","value":"By Short Code"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Call the "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#get-a-payment-request-by-short-code","rel":["nofollow"]},"children":[{"type":"text","value":"Get Payment Request by Short Code"}]},{"type":"text","value":" endpoint using the Centrapay short code that the patron obtains from their paper receipt or digital wallet transaction history."}]},{"type":"element","tag":"code","props":{"code":"sequenceDiagram\n    autonumber\n\n    participant P as Patron\n    participant POS\n    participant C as Centrapay\n\n    P->>POS: Patron Presents Short Code\n    POS->>C: Get Payment Request by Short Code\n    POS->>C: Refund Payment Request\n","language":"mermaid"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sequenceDiagram\n    autonumber\n\n    participant P as Patron\n    participant POS\n    participant C as Centrapay\n\n    P->>POS: Patron Presents Short Code\n    POS->>C: Get Payment Request by Short Code\n    POS->>C: Refund Payment Request\n"}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h3","props":{"id":"by-transaction-reference"},"children":[{"type":"text","value":"By Transaction Reference"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lookup the transaction within the merchant system using the transaction reference that the patron obtains from their paper receipt or digital wallet transaction history."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The transaction reference is made available to users of digital wallets by attaching it as the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"externalRef"}]},{"type":"text","value":" attribute when "},{"type":"element","tag":"a","props":{"href":"/guides/requesting-payment"},"children":[{"type":"text","value":"Requesting Payment"}]},{"type":"text","value":"."}]},{"type":"element","tag":"code","props":{"code":"sequenceDiagram\n    autonumber\n\n    participant P as Patron\n    participant POS\n    participant C as Centrapay\n\n    P->>POS: Patron Presents External Reference\n    POS->>C: Refund Payment Request\n","language":"mermaid"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sequenceDiagram\n    autonumber\n\n    participant P as Patron\n    participant POS\n    participant C as Centrapay\n\n    P->>POS: Patron Presents External Reference\n    POS->>C: Refund Payment Request\n"}]}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"refund-error-handling"},"children":[{"type":"text","value":"Refund Error Handling"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are a number of reasons why refunds can fail. These are documented on the "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#refund","rel":["nofollow"]},"children":[{"type":"text","value":"Refund Payment Request"}]},{"type":"text","value":" endpoint and should be communicated to the user."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Refunds that encounter unknown errors should be retried as per "},{"type":"element","tag":"a","props":{"href":"/guides/merchant-integration-error-handling"},"children":[{"type":"text","value":"Merchant Integration Error Handling"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When retrying unknown errors is impossible, POS operators may need to select a different refund method."}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"multi-asset-selection"},"children":[{"type":"text","value":"Multi-Asset Selection"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"Payment Requests"}]},{"type":"text","value":" may be paid by multiple assets. When refunding a multi-asset Payment Request, the refunded asset is not controllable by the merchant."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The asset(s) to refund will be selected automatically based on the asset type refund priority. In general, the most flexible asset types will have the highest priority.  For example, assets that are acceptable at the broadest number of merchants (ie, cash equivalent assets) will be refunded first and the most restrictive assets will be refunded last."}]}]}]},"_type":"markdown","_id":"content:guides:initiating-refunds.md","_source":"content","_file":"guides/initiating-refunds.md","_extension":"md"},{"_path":"/guides/merchant-integration-barcode-flow","_dir":"guides","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Barcode Flow for Merchants","description":"Connecting with Patrons using our Barcode Flow requires the Patron to present a Barcode and the merchant integration to scan it in order to create a Payment Request.","excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Connecting with Patrons using our Barcode Flow requires the Patron to present a Barcode and the merchant integration to scan it in order to "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#create-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"create a Payment Request"}]},{"type":"text","value":"."}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"barcode-flow"},"children":[{"type":"text","value":"Barcode Flow"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The sequence diagram below indicates the expected flow of behaviour between the Patron, the Point of Sale (POS) and Centrapay."}]},{"type":"element","tag":"code","props":{"code":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Note over Patron: Present Barcode\n    Patron->>POS: Scan Barcode\n\n    POS->>Centrapay: Create Payment Request with Barcode\n\n    par\n        loop\n            POS->>Centrapay: Poll for Payment Confirmation\n        end\n\n        Patron->>Centrapay: Pay Payment Request\n    end\n\n    Note over POS: ✅ Display Successful Payment\n    Note over Patron: ✅ Display Successful Payment\n","language":"mermaid"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Note over Patron: Present Barcode\n    Patron->>POS: Scan Barcode\n\n    POS->>Centrapay: Create Payment Request with Barcode\n\n    par\n        loop\n            POS->>Centrapay: Poll for Payment Confirmation\n        end\n\n        Patron->>Centrapay: Pay Payment Request\n    end\n\n    Note over POS: ✅ Display Successful Payment\n    Note over Patron: ✅ Display Successful Payment\n"}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Patron presents a Barcode for the POS to scan."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The POS "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#create-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"creates a Centrapay Payment Request"}]},{"type":"text","value":" with the Barcode."},{"type":"element","tag":"code","props":{"code":"curl -X POST https://service.centrapay.com/api/payment-requests \\\n  -H \"X-Api-Key: $api_key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"barcode\": \"123456789\",\n    \"configId\": \"5ee168e8597be5002af7b454\",\n    \"value\": {\n      \"amount\": \"10000\",\n      \"currency\": \"NZD\"\n    }\n  }'\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -X POST https://service.centrapay.com/api/payment-requests \\\n  -H \"X-Api-Key: $api_key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"barcode\": \"123456789\",\n    \"configId\": \"5ee168e8597be5002af7b454\",\n    \"value\": {\n      \"amount\": \"10000\",\n      \"currency\": \"NZD\"\n    }\n  }'\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"centrapay.nzd.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"centrapay.nzd.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The POS "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#get-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"polls the Payment Request for"}]},{"type":"text","value":" Payment Confirmation."},{"type":"element","tag":"code","props":{"code":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"centrapay.nzd.main\"\n    }\n  ],\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"centrapay.nzd.main\"\n    }\n  ],\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"While the POS continues to poll, the Patron "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#pay-a-payment-request-experimental","rel":["nofollow"]},"children":[{"type":"text","value":"pays the Payment Request"}]},{"type":"text","value":" via their Centrapay integrated app."},{"type":"element","tag":"code","props":{"code":"curl -X POST https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw/pay \\\n  -H \"Authorization: $jwt\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"assetType\": \"centrapay.nzd.main\",\n    \"assetId\": \"WRhAxxWpTKb5U7pXyxQjjY\"\n  }'\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -X POST https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw/pay \\\n  -H \"Authorization: $jwt\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"assetType\": \"centrapay.nzd.main\",\n    \"assetId\": \"WRhAxxWpTKb5U7pXyxQjjY\"\n  }'\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"activityNumber\": \"2\",\n  \"assetType\": \"centrapay.nzd.main\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"createdBy\": \"crn::user:0af834c8-1110-11ec-9072-3e22fb52e878\",\n  \"merchantAccountId\": \"C4QnjXvj8At6SMsEN4LRi9\",\n  \"merchantConfigId\": \"5ee168e8597be5002af7b454\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"paymentRequestCreatedBy\": \"crn::user:0af834c8-1110-11ec-9072-3e22fb52e878\",\n  \"paymentRequestId\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"type\": \"payment\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"activityNumber\": \"2\",\n  \"assetType\": \"centrapay.nzd.main\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"createdBy\": \"crn::user:0af834c8-1110-11ec-9072-3e22fb52e878\",\n  \"merchantAccountId\": \"C4QnjXvj8At6SMsEN4LRi9\",\n  \"merchantConfigId\": \"5ee168e8597be5002af7b454\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"paymentRequestCreatedBy\": \"crn::user:0af834c8-1110-11ec-9072-3e22fb52e878\",\n  \"paymentRequestId\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"type\": \"payment\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"When the Payment Request status is "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"paid"}]},{"type":"text","value":", the POS stops polling and displays confirmation of the successful payment."},{"type":"element","tag":"code","props":{"code":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"centrapay.nzd.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"paid\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"centrapay.nzd.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"paid\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"quick-pay-flow"},"children":[{"type":"text","value":"Quick Pay Flow"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Quick Pay is used to immediately confirm the payment without requiring Patron approval."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Patron’s barcode must be linked to an asset type that allows Quick Pay in order to use this flow. See "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/asset-types","rel":["nofollow"]},"children":[{"type":"text","value":"Asset Types"}]},{"type":"text","value":" for the list of asset types that support Quick Pay."}]},{"type":"element","tag":"code","props":{"code":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Note over Patron: Present Barcode\n    Patron->>POS: Scan Barcode\n\n    POS->>Centrapay: Create Payment Request with Barcode\n\n    loop\n        POS->>Centrapay: Poll for Payment Confirmation\n        note over Centrapay: Automatically Confirm the Payment\n    end\n\n    Note over POS: ✅ Display Successful Payment\n    Note over Patron: ✅ Display Successful Payment\n","language":"mermaid"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Note over Patron: Present Barcode\n    Patron->>POS: Scan Barcode\n\n    POS->>Centrapay: Create Payment Request with Barcode\n\n    loop\n        POS->>Centrapay: Poll for Payment Confirmation\n        note over Centrapay: Automatically Confirm the Payment\n    end\n\n    Note over POS: ✅ Display Successful Payment\n    Note over Patron: ✅ Display Successful Payment\n"}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Patron presents a Barcode for the POS to scan."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The POS "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#create-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"creates a Centrapay Payment Request"}]},{"type":"text","value":" with the Barcode."},{"type":"element","tag":"code","props":{"code":"curl -X POST https://service.centrapay.com/api/payment-requests \\\n  -H \"X-Api-Key: $api_key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"barcode\": \"123456789\",\n    \"configId\": \"5ee168e8597be5002af7b454\",\n    \"value\": {\n      \"amount\": \"10000\",\n      \"currency\": \"NZD\"\n    }\n  }'\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -X POST https://service.centrapay.com/api/payment-requests \\\n  -H \"X-Api-Key: $api_key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"barcode\": \"123456789\",\n    \"configId\": \"5ee168e8597be5002af7b454\",\n    \"value\": {\n      \"amount\": \"10000\",\n      \"currency\": \"NZD\"\n    }\n  }'\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The POS "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#get-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"polls the Payment Request for"}]},{"type":"text","value":" payment confirmation."},{"type":"element","tag":"code","props":{"code":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When Centrapay receives the first attempt to poll the Payment Request, it will automatically trigger payment. After payment is successful and the Payment Request status is "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"paid"}]},{"type":"text","value":"; the POS stops polling and displays confirmation of the successful payment."},{"type":"element","tag":"code","props":{"code":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl https://service.centrapay.com/api/payment-requests/MhocUmpxxmgdHjr7DgKoKw \\\n  -H \"Authorization: $jwt\"\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"paid\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"paid\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"checking-barcode-details"},"children":[{"type":"text","value":"Checking Barcode Details"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The POS can optionally "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/scanned-codes#decode-scanned-code","rel":["nofollow"]},"children":[{"type":"text","value":"decode a scanned barcode"}]},{"type":"text","value":" in order to get further details about a barcode before it creates a Payment Request. For example, the POS can use the barcode "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"provider"}]},{"type":"text","value":" to apply any provider-specific discounts before creating the Payment Request."}]},{"type":"element","tag":"code","props":{"code":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Note over Patron: Present Barcode\n    Patron->>POS: Scan Barcode\n\n    POS->>Centrapay: Decode Barcode\n    Note over POS: Apply Provider Discounts\n\n    POS->>Centrapay: Create Payment Request with Barcode\n","language":"mermaid"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Note over Patron: Present Barcode\n    Patron->>POS: Scan Barcode\n\n    POS->>Centrapay: Decode Barcode\n    Note over POS: Apply Provider Discounts\n\n    POS->>Centrapay: Create Payment Request with Barcode\n"}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Patron presents a barcode for the POS to scan."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The POS "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/scanned-codes#decode-scanned-code","rel":["nofollow"]},"children":[{"type":"text","value":"decodes the scanned barcode"}]},{"type":"text","value":" and applies any provider-related discounts."},{"type":"element","tag":"code","props":{"code":"curl -X POST https://service.centrapay.com/api/decode \\\n  -H \"Authorization: $jwt\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"code\": \"123456789\",\n    \"merchantConfigId\": \"5ee168e8597be5002af7b454\",\n    \"scannedBy\": \"merchant\"\n  }'\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -X POST https://service.centrapay.com/api/decode \\\n  -H \"Authorization: $jwt\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"code\": \"123456789\",\n    \"merchantConfigId\": \"5ee168e8597be5002af7b454\",\n    \"scannedBy\": \"merchant\"\n  }'\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"code\": \"123456789\",\n  \"displayName\": \"PayPal\",\n  \"merchantConfigId\": \"5ee168e8597be5002af7b454\",\n  \"provider\": \"paypal\",\n  \"scannedBy\": \"merchant\"\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"code\": \"123456789\",\n  \"displayName\": \"PayPal\",\n  \"merchantConfigId\": \"5ee168e8597be5002af7b454\",\n  \"provider\": \"paypal\",\n  \"scannedBy\": \"merchant\"\n}\n"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The POS "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#create-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"creates a Payment Request"}]},{"type":"text","value":" with the barcode and continues with either the "},{"type":"element","tag":"a","props":{"href":"#barcode-flow"},"children":[{"type":"text","value":"Barcode Flow"}]},{"type":"text","value":" or "},{"type":"element","tag":"a","props":{"href":"#quick-pay-flow"},"children":[{"type":"text","value":"Quick Pay Flow"}]},{"type":"text","value":"."},{"type":"element","tag":"code","props":{"code":"curl -X POST https://service.centrapay.com/api/payment-requests \\\n  -H \"X-Api-Key: $api_key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"barcode\": \"123456789\",\n    \"configId\": \"5ee168e8597be5002af7b454\",\n    \"value\": {\n      \"amount\": \"10000\",\n      \"currency\": \"NZD\"\n    }\n  }'\n","filename":"Request","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -X POST https://service.centrapay.com/api/payment-requests \\\n  -H \"X-Api-Key: $api_key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"barcode\": \"123456789\",\n    \"configId\": \"5ee168e8597be5002af7b454\",\n    \"value\": {\n      \"amount\": \"10000\",\n      \"currency\": \"NZD\"\n    }\n  }'\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n","filename":"Response","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"barcode\": \"123456789\",\n  \"configId\": \"5ee168e8597be5002af7b454\",\n  \"createdAt\": \"2021-06-08T04:04:27.426Z\",\n  \"expiresAt\": \"2021-06-08T04:06:27.426Z\",\n  \"expirySeconds\": 120,\n  \"id\": \"MhocUmpxxmgdHjr7DgKoKw\",\n  \"merchantId\": \"26d3Cp3rJmbMHnuNJmks2N\",\n  \"merchantName\": \"Centrapay Café\",\n  \"patronCodeId\": \"V17FByEP9gm1shSG6a1Zzx\",\n  \"paymentOptions\": [\n    {\n      \"amount\": \"10000\",\n      \"assetType\": \"paypal.main\"\n    }\n  ],\n  \"purchaseOrderRef\": \"oF6kj1QlH5gK0y9rjRHFh2\",\n  \"shortCode\": \"CP-C7F-ZS5\",\n  \"status\": \"new\",\n  \"updatedAt\": \"2021-06-08T04:04:27.426Z\",\n  \"url\": \"https://app.centrapay.com/pay/MhocUmpxxmgdHjr7DgKoKw\",\n  \"value\": {\n    \"currency\": \"NZD\",\n    \"amount\": \"10000\"\n  }\n}\n"}]}]}]}]}]}]}]},"_type":"markdown","_id":"content:guides:merchant-integration-barcode-flow.md","_source":"content","_file":"guides/merchant-integration-barcode-flow.md","_extension":"md"}]