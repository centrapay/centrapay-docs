{"_path":"/guides/requesting-payment","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Requesting Payment","description":"Centrapay’s payment protocol requires a merchant integration to connect with the Patron in order to create a Payment Request; and poll it for payment confirmation.","excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Centrapay’s payment protocol requires a merchant integration to connect with the Patron in order to create a "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests","rel":["nofollow"]},"children":[{"type":"text","value":"Payment Request"}]},{"type":"text","value":"; and poll it for payment confirmation."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additionally, merchant integrations can opt into protocol extensions when creating a Payment Request in order to unlock acceptance of a wider set of payment options."}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"connecting-with-patrons"},"children":[{"type":"text","value":"Connecting With Patrons"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests","rel":["nofollow"]},"children":[{"type":"text","value":"Payment Request"}]},{"type":"text","value":" object is a core part of Centrapay’s payment protocol. It represents the intention of a merchant to receive payment, defines the amount to be paid, and the acceptable "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/asset-types","rel":["nofollow"]},"children":[{"type":"text","value":"Asset Types"}]},{"type":"text","value":" for payment."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#create-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"create a Payment Request"}]},{"type":"text","value":", a merchant integration must connect with the Patron. Centrapay supports 2 different options to connect with Patrons. We recommend that merchant integrations implement both options to support the complete set of apps within Centrapay’s ecosystem."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/merchant-integration-qr-code-flow"},"children":[{"type":"text","value":"QR Code Flow for Merchants"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/merchant-integration-barcode-flow"},"children":[{"type":"text","value":"Barcode Flow for Merchants"}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h3","props":{"id":"required-fields-when-creating-a-payment-request"},"children":[{"type":"text","value":"Required Fields When Creating a Payment Request"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We require compliant integrations to provide the following optional fields when creating a Payment Request."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Name"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"externalRef"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The merchant’s identifier for the transaction. Typically this is also printed on the paper receipt and required for "},{"type":"element","tag":"a","props":{"href":"/guides/initiating-refunds"},"children":[{"type":"text","value":"Initiating Refunds"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"terminalId"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The logical identifier of the terminal. Useful for auditing and debugging."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"deviceId"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The hardware identifier of the terminal. Useful for auditing and debugging."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"patronNotPresent"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"This flag indicates whether a Patron is physically present at the point of sale. Setting this flag can change the liability for some asset types."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"conditionsEnabled"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The flag which indicates "},{"type":"element","tag":"a","props":{"href":"/guides/merchant-payment-conditions"},"children":[{"type":"text","value":"Merchant Payment Conditions"}]},{"type":"text","value":" are supported."}]}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h3","props":{"id":"short-codes"},"children":[{"type":"text","value":"Short Codes"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Payment Requests have a short code that is human- and OCR-friendly. Short codes are recycled every two years. When combined with the date or merchant id, short codes can unambiguously identify the correct Payment Request."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A short code can be displayed to a user instead of the Payment Request ID; e.g. on paper printouts."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Short codes can be used for "},{"type":"element","tag":"a","props":{"href":"/guides/initiating-refunds"},"children":[{"type":"text","value":"Initiating Refunds"}]},{"type":"text","value":"."}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"polling-for-payment-confirmation"},"children":[{"type":"text","value":"Polling for Payment Confirmation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After connecting with the Patron, the POS must "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#get-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"poll the Payment Request status"}]},{"type":"text","value":" every second until the status has changed."}]},{"type":"element","tag":"code","props":{"code":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Patron->>POS: Connect with Patron\n    loop Poll every second until status changes\n        POS->>Centrapay: Get Payment Request Status\n    end\n\n    note over POS: ✅ Display Confirmation\n","language":"mermaid"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Patron->>POS: Connect with Patron\n    loop Poll every second until status changes\n        POS->>Centrapay: Get Payment Request Status\n    end\n\n    note over POS: ✅ Display Confirmation\n"}]}]}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Payment Request Status"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Integrator Behaviour"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"new"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Check for "},{"type":"element","tag":"a","props":{"href":"/guides/merchant-payment-conditions"},"children":[{"type":"text","value":"Merchant Payment Conditions"}]},{"type":"text","value":" then poll again for status change."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"paid"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Show Confirmation. Stop polling."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"expired"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Show payment timed-out message. Stop polling."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"cancelled"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Show cancellation reason. Stop polling."}]}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"protocol-extensions"},"children":[{"type":"text","value":"Protocol Extensions"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Our payment protocol supports several optional extensions. Please review the extensions below and determine which ones you need for your integration."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/merchant-payment-conditions"},"children":[{"type":"text","value":"Merchant Payment Conditions"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/requesting-pre-auth"},"children":[{"type":"text","value":"Requesting Pre Auth"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/payment-request-line-items"},"children":[{"type":"text","value":"Payment Request Line Items"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/patron-not-present"},"children":[{"type":"text","value":"Patron Not Present"}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"handling-payment-errors"},"children":[{"type":"text","value":"Handling Payment Errors"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Merchant integrations should follow our guidelines in "},{"type":"element","tag":"a","props":{"href":"/guides/merchant-integration-error-handling"},"children":[{"type":"text","value":"Merchant Integration Error Handling"}]},{"type":"text","value":" when inconsistencies such as network issues or race conditions occur."}]}]}]},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Centrapay’s payment protocol requires a merchant integration to connect with the Patron in order to create a "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests","rel":["nofollow"]},"children":[{"type":"text","value":"Payment Request"}]},{"type":"text","value":"; and poll it for payment confirmation."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additionally, merchant integrations can opt into protocol extensions when creating a Payment Request in order to unlock acceptance of a wider set of payment options."}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"connecting-with-patrons"},"children":[{"type":"text","value":"Connecting With Patrons"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests","rel":["nofollow"]},"children":[{"type":"text","value":"Payment Request"}]},{"type":"text","value":" object is a core part of Centrapay’s payment protocol. It represents the intention of a merchant to receive payment, defines the amount to be paid, and the acceptable "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/asset-types","rel":["nofollow"]},"children":[{"type":"text","value":"Asset Types"}]},{"type":"text","value":" for payment."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#create-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"create a Payment Request"}]},{"type":"text","value":", a merchant integration must connect with the Patron. Centrapay supports 2 different options to connect with Patrons. We recommend that merchant integrations implement both options to support the complete set of apps within Centrapay’s ecosystem."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/merchant-integration-qr-code-flow"},"children":[{"type":"text","value":"QR Code Flow for Merchants"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/merchant-integration-barcode-flow"},"children":[{"type":"text","value":"Barcode Flow for Merchants"}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h3","props":{"id":"required-fields-when-creating-a-payment-request"},"children":[{"type":"text","value":"Required Fields When Creating a Payment Request"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We require compliant integrations to provide the following optional fields when creating a Payment Request."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Name"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"externalRef"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The merchant’s identifier for the transaction. Typically this is also printed on the paper receipt and required for "},{"type":"element","tag":"a","props":{"href":"/guides/initiating-refunds"},"children":[{"type":"text","value":"Initiating Refunds"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"terminalId"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The logical identifier of the terminal. Useful for auditing and debugging."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"deviceId"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The hardware identifier of the terminal. Useful for auditing and debugging."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"patronNotPresent"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"This flag indicates whether a Patron is physically present at the point of sale. Setting this flag can change the liability for some asset types."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"conditionsEnabled"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"The flag which indicates "},{"type":"element","tag":"a","props":{"href":"/guides/merchant-payment-conditions"},"children":[{"type":"text","value":"Merchant Payment Conditions"}]},{"type":"text","value":" are supported."}]}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h3","props":{"id":"short-codes"},"children":[{"type":"text","value":"Short Codes"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Payment Requests have a short code that is human- and OCR-friendly. Short codes are recycled every two years. When combined with the date or merchant id, short codes can unambiguously identify the correct Payment Request."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A short code can be displayed to a user instead of the Payment Request ID; e.g. on paper printouts."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Short codes can be used for "},{"type":"element","tag":"a","props":{"href":"/guides/initiating-refunds"},"children":[{"type":"text","value":"Initiating Refunds"}]},{"type":"text","value":"."}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"polling-for-payment-confirmation"},"children":[{"type":"text","value":"Polling for Payment Confirmation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After connecting with the Patron, the POS must "},{"type":"element","tag":"a","props":{"href":"https://docs.centrapay.com/api/payment-requests#get-a-payment-request","rel":["nofollow"]},"children":[{"type":"text","value":"poll the Payment Request status"}]},{"type":"text","value":" every second until the status has changed."}]},{"type":"element","tag":"code","props":{"code":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Patron->>POS: Connect with Patron\n    loop Poll every second until status changes\n        POS->>Centrapay: Get Payment Request Status\n    end\n\n    note over POS: ✅ Display Confirmation\n","language":"mermaid"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sequenceDiagram\n    autonumber\n\n    participant Patron\n    participant POS\n    participant Centrapay\n\n    Patron->>POS: Connect with Patron\n    loop Poll every second until status changes\n        POS->>Centrapay: Get Payment Request Status\n    end\n\n    note over POS: ✅ Display Confirmation"}]}]}]}]}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Payment Request Status"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Integrator Behaviour"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"new"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Check for "},{"type":"element","tag":"a","props":{"href":"/guides/merchant-payment-conditions"},"children":[{"type":"text","value":"Merchant Payment Conditions"}]},{"type":"text","value":" then poll again for status change."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"paid"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Show Confirmation. Stop polling."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"expired"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Show payment timed-out message. Stop polling."}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"cancelled"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Show cancellation reason. Stop polling."}]}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"protocol-extensions"},"children":[{"type":"text","value":"Protocol Extensions"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Our payment protocol supports several optional extensions. Please review the extensions below and determine which ones you need for your integration."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/merchant-payment-conditions"},"children":[{"type":"text","value":"Merchant Payment Conditions"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/requesting-pre-auth"},"children":[{"type":"text","value":"Requesting Pre Auth"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/payment-request-line-items"},"children":[{"type":"text","value":"Payment Request Line Items"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/guides/patron-not-present"},"children":[{"type":"text","value":"Patron Not Present"}]}]}]}]},{"type":"element","tag":"section","props":{},"children":[{"type":"element","tag":"h2","props":{"id":"handling-payment-errors"},"children":[{"type":"text","value":"Handling Payment Errors"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Merchant integrations should follow our guidelines in "},{"type":"element","tag":"a","props":{"href":"/guides/merchant-integration-error-handling"},"children":[{"type":"text","value":"Merchant Integration Error Handling"}]},{"type":"text","value":" when inconsistencies such as network issues or race conditions occur."}]}]}],"toc":{"title":"","searchDepth":4,"depth":4,"links":[{"id":"connecting-with-patrons","depth":2,"text":"Connecting With Patrons","children":[{"id":"required-fields-when-creating-a-payment-request","depth":3,"text":"Required Fields When Creating a Payment Request"},{"id":"short-codes","depth":3,"text":"Short Codes"}]},{"id":"polling-for-payment-confirmation","depth":2,"text":"Polling for Payment Confirmation"},{"id":"protocol-extensions","depth":2,"text":"Protocol Extensions"},{"id":"handling-payment-errors","depth":2,"text":"Handling Payment Errors"}]}},"_type":"markdown","_id":"content:guides:requesting-payment.md","_source":"content","_file":"guides/requesting-payment.md","_extension":"md"}