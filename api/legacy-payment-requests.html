<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Legacy - Centrapay Docs</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Legacy | Centrapay Docs</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="Legacy" /> <meta property="og:locale" content="en_US" /> <meta property="og:site_name" content="Centrapay Docs" /> <script type="application/ld+json"> {"url":"/api/legacy-payment-requests","@type":"WebPage","headline":"Legacy","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> Centrapay Docs </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/guides" class="nav-list-link">Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="/guides/introduction" class="nav-list-link">Guides</a></li><li class="nav-list-item "><a href="/guides/merchant-terminals" class="nav-list-link">Merchant Terminals</a></li><li class="nav-list-item "><a href="/guides/payment-flows" class="nav-list-link">Payment Flows</a></li><li class="nav-list-item "><a href="/guides/creating-test-money" class="nav-list-link">Creating Test Money</a></li><li class="nav-list-item "><a href="/guides/ecommerce" class="nav-list-link">eCommerce</a></li><li class="nav-list-item "><a href="/guides/example-oidc-consumer" class="nav-list-link">Example OIDC Consumer</a></li><li class="nav-list-item "><a href="/guides/loading-and-sending-assets" class="nav-list-link">Loading & Sending Assets</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api" class="nav-list-link">API Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/api/introduction" class="nav-list-link">API Introduction</a></li><li class="nav-list-item "><a href="/api/auth" class="nav-list-link">Auth</a></li><li class="nav-list-item "><a href="/api/http-status-codes" class="nav-list-link">HTTP Status Codes</a></li><li class="nav-list-item "><a href="/api/data-types" class="nav-list-link">Data Types</a></li><li class="nav-list-item "><a href="/api/pagination" class="nav-list-link">Pagination</a></li><li class="nav-list-item "><a href="/api/api-keys" class="nav-list-link">API Keys</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/accounts" class="nav-list-link">Accounts</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/accounts" class="nav-list-link">Accounts</a> </li><li class="nav-list-item "> <a href="/api/account-memberships" class="nav-list-link">Account Memberships</a> </li><li class="nav-list-item "> <a href="/api/businesses" class="nav-list-link">Businesses</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/assets" class="nav-list-link">Assets</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/assets" class="nav-list-link">Assets</a> </li><li class="nav-list-item "> <a href="/api/asset-transfers" class="nav-list-link">Asset Transfers</a> </li><li class="nav-list-item "> <a href="/api/asset-types" class="nav-list-link">Asset Types</a> </li><li class="nav-list-item "> <a href="/api/external-assets" class="nav-list-link">External Assets</a> </li><li class="nav-list-item "> <a href="/api/wallets" class="nav-list-link">Wallets</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/bank-accounts" class="nav-list-link">Bank Accounts</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/bank-accounts" class="nav-list-link">Bank Accounts</a> </li><li class="nav-list-item "> <a href="/api/bank-account-approvals" class="nav-list-link">Bank Account Approvals</a> </li><li class="nav-list-item "> <a href="/api/bank-account-connection-intents" class="nav-list-link">Bank Account Connection Intents</a> </li><li class="nav-list-item "> <a href="/api/funds-transfers" class="nav-list-link">Funds Transfers</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/batches" class="nav-list-link">Batches</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/batches" class="nav-list-link">Batches</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/integrations" class="nav-list-link">Integrations</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/integrations" class="nav-list-link">Integrations</a> </li><li class="nav-list-item "> <a href="/api/integration-requests" class="nav-list-link">Integration Requests</a> </li><li class="nav-list-item "> <a href="/api/managed-integrations" class="nav-list-link">Managed Integrations</a> </li></ul></li><li class="nav-list-item "><a href="/api/invitations.html" class="nav-list-link">Invitations</a></li><li class="nav-list-item "><a href="/api/media-uploads" class="nav-list-link">Media Uploads</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/merchants" class="nav-list-link">Merchants</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/merchants" class="nav-list-link">Merchants</a> </li><li class="nav-list-item "> <a href="/api/merchant-configs" class="nav-list-link">Merchant Configs</a> </li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/payment-requests" class="nav-list-link">Payment Requests</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/payment-requests" class="nav-list-link">Payment Requests</a> </li><li class="nav-list-item active"> <a href="/api/legacy-payment-requests" class="nav-list-link active">Legacy</a> </li></ul></li><li class="nav-list-item "><a href="/api/profiles" class="nav-list-link">Profiles</a></li><li class="nav-list-item "><a href="/api/quotas" class="nav-list-link">Quotas</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/scanned-codes" class="nav-list-link">Scanned Codes</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/scanned-codes" class="nav-list-link">Scanned Codes</a> </li><li class="nav-list-item "> <a href="/api/patron-codes" class="nav-list-link">Patron Codes</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/api/section/settlements" class="nav-list-link">Settlements</a><ul class="nav-list"><li class="nav-list-item "> <a href="/api/settlements" class="nav-list-link">Settlements</a> </li></ul></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Centrapay Docs" aria-label="Search Centrapay Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://centrapay.com" class="site-button" > Centrapay </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/api">API Reference</a></li> <li class="breadcrumb-nav-list-item"><a href="/api/section/payment-requests">Payment Requests</a></li> <li class="breadcrumb-nav-list-item"><span>Legacy</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="legacy-payment-requests"> <a href="#legacy-payment-requests" aria-labelledby="legacy-payment-requests" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Legacy Payment Requests </h1> <p>Centrapay Payment Requests are serviced via two sets of endpoints; the “next” version (documented <a href="/api/payment-requests">Payment Requests</a>) and the “legacy” version (documented on this page). Use of legacy endpoints for new integrations is discouraged where alternative endpoints have been provided.</p> <p>Legacy Payment Request endpoints also have <a href="https://service.centrapay.com/payments/api/documentation" target="\_blank" class="external">interactive Swagger documentation</a>.</p> <h2 class="no_toc text-delta" id="contents"> <a href="#contents" aria-labelledby="contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Contents </h2> <ul id="markdown-toc"> <li><a href="#operations" id="markdown-toc-operations">Operations</a> <ul> <li><a href="#creating-a-payment-request" id="markdown-toc-creating-a-payment-request">Creating a payment request</a></li> <li><a href="#getting-the-information-about-a-payment-request" id="markdown-toc-getting-the-information-about-a-payment-request">Getting the information about a payment request</a></li> <li><a href="#paying-a-payment-request" id="markdown-toc-paying-a-payment-request">Paying a payment request</a></li> <li><a href="#cancelling-a-payment-request" id="markdown-toc-cancelling-a-payment-request">Cancelling a payment request</a></li> <li><a href="#voiding-a-payment-request" id="markdown-toc-voiding-a-payment-request">Voiding a payment request</a></li> <li><a href="#refunding-a-transaction" id="markdown-toc-refunding-a-transaction">Refunding a transaction</a></li> </ul> </li> <li><a href="#webhooks" id="markdown-toc-webhooks">Webhooks</a> <ul> <li><a href="#life-cycle-events-that-trigger-webhooks" id="markdown-toc-life-cycle-events-that-trigger-webhooks">Life-cycle Events That Trigger Webhooks</a></li> <li><a href="#webhook-payload" id="markdown-toc-webhook-payload">Webhook Payload</a></li> <li><a href="#webhook-jwt-validation" id="markdown-toc-webhook-jwt-validation">Webhook JWT Validation</a></li> <li><a href="#decoded-webhook-jwt-examples" id="markdown-toc-decoded-webhook-jwt-examples">Decoded Webhook JWT Examples</a></li> </ul> </li> </ul> <h2 id="operations"> <a href="#operations" aria-labelledby="operations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Operations </h2> <p><a name="requests-create"></a></p> <h3 id="creating-a-payment-request"> <a href="#creating-a-payment-request" aria-labelledby="creating-a-payment-request" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating a payment request </h3> <p><a href="https://service.centrapay.com/payments/api/documentation#/Requests/postRequestscreate" target="\_blank" class="external">Swagger Docs</a></p> <p> POST <code>/<wbr />payments/<wbr />api/<wbr />requests.create</code> <h4> </h4> <div class="highlighter-rouge"><pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/payments/api/requests.create <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">merchantId</span><span class="o">=</span>5efbe17d96c083633e2b9241 <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">clientId</span><span class="o">=</span>5efbe2fb96c08357bb2b9242 <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">amount</span><span class="o">=</span>300 <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">asset</span><span class="o">=</span>NZD</code></pre></div> </p> <h4> Required Parameters </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Parameter</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">amount</td> <td style="text-align: left">The payment amount in cents</td> </tr> <tr> <td style="text-align: left">asset</td> <td style="text-align: left">The currency code (e.g. ‘NZD’)</td> </tr> <tr> <td style="text-align: left">merchantId</td> <td style="text-align: left">The id of the merchant creating the request</td> </tr> <tr> <td style="text-align: left">clientId</td> <td style="text-align: left">The id of the merchant specific client configuration</td> </tr> </tbody> </table></div> <p>See <a href="/api/asset-types">Asset Types</a> for the list of possible <code class="language-plaintext highlighter-rouge">asset</code> values for each Asset Type.</p> <h4> Optional Parameters </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Parameter</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">description</td> <td style="text-align: left">Description of the payment</td> </tr> <tr> <td style="text-align: left">externalReference</td> <td style="text-align: left">Unique merchant reference for the payment request</td> </tr> <tr> <td style="text-align: left">notifyUrl</td> <td style="text-align: left">The URL that will receive <strong>POST</strong> requests from the webhook</td> </tr> <tr> <td style="text-align: left">paymentExpirySeconds</td> <td style="text-align: left">The amount of seconds until a request expires, must be an integer greater than 0 and less than 86400 (24 hours)</td> </tr> <tr> <td style="text-align: left">terminalId</td> <td style="text-align: left">The payment system terminal Id. Required for NZ Epay integration.</td> </tr> <tr> <td style="text-align: left">deviceId</td> <td style="text-align: left">Physical payment system device Id</td> </tr> <tr> <td style="text-align: left">patronCode</td> <td style="text-align: left">Associate this payment request with an active Patron Code.</td> </tr> </tbody> </table></div> <h4> Error Responses </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Status</th> <th style="text-align: left">Code</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">400</td> <td style="text-align: left">CHECKSUM_<wbr />FAILED</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">patronCode</code> luhn checksum digit doesn’t pass.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">PATRON_<wbr />CODE_<wbr />INVALID</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">patronCode</code> doesn’t exist or has expired.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">MERCHANT_<wbr />CONFIGURATION_<wbr />NOT_<wbr />FOUND</td> <td style="text-align: left">There was no merchant configuration found for the supplied merchantId and clientId.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">NO_<wbr />AVAILABLE_<wbr />PAYMENT_<wbr />OPTIONS</td> <td style="text-align: left">No payment options match the requested payment parameters.</td> </tr> </tbody> </table></div> <p><a name="requests-info"></a></p> <h3 id="getting-the-information-about-a-payment-request"> <a href="#getting-the-information-about-a-payment-request" aria-labelledby="getting-the-information-about-a-payment-request" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Getting the information about a payment request </h3> <p><a href="https://service.centrapay.com/payments/api/documentation#/Requests/getRequestsinfo" target="\_blank" class="external">Swagger Docs</a></p> <p> GET <code>/<wbr />payments/<wbr />api/<wbr />requests.info</code> <h4> </h4> <div class="highlighter-rouge"><pre class="highlight"><code>curl <span class="nt">-G</span> https://service.centrapay.com/payments/api/requests.info <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">requestId</span><span class="o">=</span>TyqV56mEkNLUeiY2QskHNR</code></pre></div> </p> <h4> Required Parameters </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Parameter</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">requestId</td> <td style="text-align: left">The payment requestId that is generated when <a href="#requests-create">requests.create</a> is called</td> </tr> </tbody> </table></div> <h4> Error Responses </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Http code</th> <th style="text-align: left">Error code</th> <th style="text-align: left">Message</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">404</td> <td style="text-align: left">2</td> <td style="text-align: left">REQUEST_<wbr />NOT_<wbr />FOUND</td> <td style="text-align: left">The provided request doesn’t exist.</td> </tr> </tbody> </table></div> <h4> Example response payload of a new request </h4> <p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TyqV56mEkNLUeiY2QskHNR"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"shortCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CP-C7F-ZS5"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"merchantId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5efbe17d96c083633e2b9241"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"merchantName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD Test Merchant"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5efbe2fb96c08357bb2b9242"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"denomination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"payments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ledger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"centrapay.nzd.test"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"qr_code"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"qrCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://app.centrapay.com/pay/TyqV56mEkNLUeiY2QskHNR"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"requestCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://app.centrapay.com/pay/TyqV56mEkNLUeiY2QskHNR"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"new"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-11-29T23:04:54.253Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-11-29T23:04:54.253Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"liveness"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"paymentExpirySeconds"</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="w">
</span><span class="p">}</span></code></pre></div> </p> <h4> Example response payload of a paid request </h4> <p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TyqV56mEkNLUeiY2QskHNR"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"shortCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CP-C7F-ZS5"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"merchantId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5efbe17d96c083633e2b9241"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"merchantName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD Test Merchant"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5efbe2fb96c08357bb2b9242"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"denomination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"payments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ledger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"centrapay.nzd.test"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"qr_code"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"qrCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://app.centrapay.com/pay/TyqV56mEkNLUeiY2QskHNR"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"requestCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://app.centrapay.com/pay/TyqV56mEkNLUeiY2QskHNR"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"paid"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-11-29T23:04:54.253Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-11-29T23:05:38.254Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"liveness"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"paymentExpirySeconds"</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w">
  </span><span class="nl">"paidBy"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ledger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"centrapay.nzd.test"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"centrapay.nzd.test"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"authCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3MhaANvdS79qhvAj6nYFNT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"responseCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"receipt"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"v2"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"paidAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-11-29T23:05:38.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3MhaANvdS79qhvAj6nYFNT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"transactionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TyqV56mEkNLUeiY2QskHNR"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Centrapay Test NZD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"settlementDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-11-29T23:05:38.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"assetTotals"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"centrapay.nzd.test"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Centrapay Test NZD"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"settlementDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-11-29T23:05:38.000Z"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"total"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></div> </p> <p><a name="requests-pay"></a></p> <h3 id="paying-a-payment-request"> <a href="#paying-a-payment-request" aria-labelledby="paying-a-payment-request" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Paying a payment request </h3> <p><a href="https://service.centrapay.com/payments/api/documentation#/Requests/postRequestspay" target="\_blank" class="external">Swagger Docs</a></p> <p> POST <code>/<wbr />payments/<wbr />api/<wbr />requests.pay</code> <h4> </h4> <div class="highlighter-rouge"><pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/payments/api/requests.pay <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">authorization</span><span class="o">=</span>12345678 <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">ledger</span><span class="o">=</span>g.pocketvouchers.pv <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">requestId</span><span class="o">=</span>7d2b1d52-b609-4ccd-b4cc-c4a9af881bd9</code></pre></div> </p> <h4> Required Parameters </h4> <div class="table-wrapper"><table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>requestId</td> <td>The id of the payment request to pay. See <a href="#requests-create">requests.create</a>.</td> </tr> <tr> <td>ledger</td> <td>The selected payment option to use. See below for expected values.</td> </tr> <tr> <td>authorization</td> <td>An identifier that can be used to pay or verify payment. See below for expected values.</td> </tr> </tbody> </table></div> <h4> Expected Ledger and Authorization Values </h4> <p>The “ledger” parameter indicates which payment option has been selected to pay the payment request. The selected payment option must be one of the options available for the payment request as per the <code class="language-plaintext highlighter-rouge">payments</code> array in the <a href="#requests-create">requests.create</a> and <a href="#requests-info">requests.info</a> responses.</p> <p>The table below lists the possible ledger and authorization param values. The asset type is the value used to configure the merchant. The ledger param value is returned with the payment request info as <code class="language-plaintext highlighter-rouge">payments[].ledger</code>.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Asset Type</th> <th style="text-align: left">Ledger Param Value</th> <th style="text-align: left">Authorization Param Value</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">centrapay.nzd.main</td> <td style="text-align: left">centrapay.nzd.main</td> <td style="text-align: left"><em>Centrapay wallet id</em></td> </tr> <tr> <td style="text-align: left">centrapay.nzd.test</td> <td style="text-align: left">centrapay.nzd.test</td> <td style="text-align: left"><em>Centrapay wallet id</em></td> </tr> <tr> <td style="text-align: left">epay.nzd.main</td> <td style="text-align: left">epay.nzd.main</td> <td style="text-align: left"><em>Centrapay asset id</em></td> </tr> <tr> <td style="text-align: left">pocketvouchers</td> <td style="text-align: left">g.pocketvouchers.pv</td> <td style="text-align: left"><em>Pocket Vouchers voucher code</em></td> </tr> <tr> <td style="text-align: left">bitcoin.main</td> <td style="text-align: left">g.crypto.bitcoin.mainnet</td> <td style="text-align: left"><em>Bitcoin transaction id</em></td> </tr> <tr> <td style="text-align: left">cennznet.main</td> <td style="text-align: left">cennznet.main</td> <td style="text-align: left"><em>Cennznet transaction id</em></td> </tr> <tr> <td style="text-align: left">zap.main</td> <td style="text-align: left">zap.main</td> <td style="text-align: left"><em>Waves transaction id</em></td> </tr> <tr> <td style="text-align: left">test</td> <td style="text-align: left">g.test.testUplink</td> <td style="text-align: left"><em>Any</em></td> </tr> </tbody> </table></div> <h4> Centrapay Asset Permissions </h4> <p>To pay with a Centrapay asset or wallet ledger the user (identified by the API Key or identity token) must have permission to redeem the asset or transfer funds from the specified wallet.</p> <h4> Testing Pocket Vouchers </h4> <p>To test Pocket Vouchers, generate a test value voucher by texting “CENTRALBONUS” to 393. You will then receive a response text containing an 8 digit voucher code that has $20 of loaded credit. The received code is only valid for two weeks from the issue date. You might get charged your standard text rates from your provider.</p> <h4> Error Responses </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Http code</th> <th style="text-align: left">Message</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">403</td> <td style="text-align: left">REQUEST_<wbr />EXPIRED</td> <td style="text-align: left">Action cannot be completed because the request has expired.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">REQUEST_<wbr />PAID</td> <td style="text-align: left">Action cannot be completed because the request has been paid.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">REQUEST_<wbr />CANCELLED</td> <td style="text-align: left">Action cannot be completed because the request has already been cancelled.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">INVALID_<wbr />ASSET_<wbr />TYPE</td> <td style="text-align: left">The merchant is not configured with the provided asset type.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">INACTIVE_<wbr />ASSET</td> <td style="text-align: left">The asset is not spendable. It may have been disabled, expired, or already spent.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">INVALID_<wbr />MERCHANT_<wbr />CONFIG</td> <td style="text-align: left">The merchant is not configured properly to satisfy the payment request. This could be due to incorrect information, or the merchant’s credentials might be blocked by an external service.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">QUOTA_<wbr />EXCEEDED</td> <td style="text-align: left">The payment pay request exceeds the allowed spend quota supplied.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">INSUFFICIENT_<wbr />ASSET_<wbr />VALUE</td> <td style="text-align: left">The asset has insufficient funds to pay the payment request or the transaction amount received by Centrapay is less than the total of the payment.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">ASSET_<wbr />REDEMPTION_<wbr />DENIED</td> <td style="text-align: left">The asset redemption has been unsuccessful due to an error with provided payment parameters, the merchant, or the asset.</td> </tr> </tbody> </table></div> <p><a name="requests-cancel"></a></p> <h3 id="cancelling-a-payment-request"> <a href="#cancelling-a-payment-request" aria-labelledby="cancelling-a-payment-request" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cancelling a payment request </h3> <p><a href="https://service.centrapay.com/payments/api/documentation#/Requests/postRequestscancel" target="\_blank" class="external">Swagger Docs</a></p> <p> POST <code>/<wbr />payments/<wbr />api/<wbr />requests.cancel</code> <h4> </h4> <div class="highlighter-rouge"><pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/payments/api/requests.cancel <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">requestId</span><span class="o">=</span>a95b3b0d-1278-4613-8772-20d146065a2e</code></pre></div> </p> <h4> Required Parameters </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Parameter</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">requestId</td> <td style="text-align: left">The payment requestId that is generated when <a href="#requests-create">requests.create</a> is called</td> </tr> </tbody> </table></div> <h4> Error Responses </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Http code</th> <th style="text-align: left">Error code</th> <th style="text-align: left">Message</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">404</td> <td style="text-align: left">2</td> <td style="text-align: left">REQUEST_<wbr />NOT_<wbr />FOUND</td> <td style="text-align: left">The provided request doesn’t exist.</td> </tr> <tr> <td style="text-align: left">400</td> <td style="text-align: left">18</td> <td style="text-align: left">REQUEST_<wbr />EXPIRED</td> <td style="text-align: left">Action cannot be completed because the request has expired.</td> </tr> <tr> <td style="text-align: left">400</td> <td style="text-align: left">19</td> <td style="text-align: left">REQUEST_<wbr />PAID</td> <td style="text-align: left">Action cannot be completed because the request has been paid.</td> </tr> </tbody> </table></div> <p><a name="requests-void"></a></p> <h3 id="voiding-a-payment-request"> <a href="#voiding-a-payment-request" aria-labelledby="voiding-a-payment-request" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Voiding a payment request </h3> <p><a href="https://service.centrapay.com/payments/api/documentation#/Requests/postRequestsvoid" target="\_blank" class="external">Swagger Docs</a></p> <p> POST <code>/<wbr />payments/<wbr />api/<wbr />requests.void</code> <h4> </h4> <div class="highlighter-rouge"><pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/payments/api/requests.void <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">requestId</span><span class="o">=</span>a95b3b0d-1278-4613-8772-20d146065a2e</code></pre></div> </p> <h4> Required Parameters </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Parameter</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">requestId</td> <td style="text-align: left">The payment requestId that is generated when <a href="#requests-create">requests.create</a> is called.</td> </tr> </tbody> </table></div> <h4> Error Responses </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Http code</th> <th style="text-align: left">Error code</th> <th style="text-align: left">Message</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">404</td> <td style="text-align: left">2</td> <td style="text-align: left">REQUEST_<wbr />NOT_<wbr />FOUND</td> <td style="text-align: left">The provided request doesn’t exist.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left"> </td> <td style="text-align: left">VOID_<wbr />WINDOW_<wbr />EXCEEDED</td> <td style="text-align: left">The amount of time since the payment request was created exceeds the window of time a payment request can be voided (24 hours).</td> </tr> </tbody> </table></div> <p>Voiding a payment request can cause it to be cancelled or refunded. Therefore, this endpoint can give the same error responses as <a href="#requests-cancel">requests.cancel</a> and <a href="#transactions-refund">transactions.refund</a>. After 24 hours voiding a payment request will be disallowed, however a refund can still be made against the payment request if it has been paid successfully.</p> <p><a name="transactions-refund"></a></p> <h3 id="refunding-a-transaction"> <a href="#refunding-a-transaction" aria-labelledby="refunding-a-transaction" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Refunding a transaction </h3> <p><a href="https://service.centrapay.com/payments/api/documentation#/Transactions/postTransactionsrefund" target="\_blank" class="external">Swagger Docs</a></p> <p> POST <code>/<wbr />payments/<wbr />api/<wbr />transactions.refund</code> <h4> </h4> <div class="highlighter-rouge"><pre class="highlight"><code>curl <span class="nt">-X</span> POST https://service.centrapay.com/payments/api/transactions.refund <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"X-Api-Key: </span><span class="nv">$api_key</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">transactionId</span><span class="o">=</span>7d2b1d52-b609-4ccd-b4cc-c4a9af881bd9 <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">amount</span><span class="o">=</span>100</code></pre></div> </p> <p>Refunding a transaction can be done with or without an external reference.</p> <h4> Refund without external reference </h4> <p>If you refund a transaction without providing an external reference, you will get a successful response for the first request and then an ALREADY_REFUNDED message for any refund requests that follow for the same transaction, unless an external reference is provided.</p> <h4> Refund with external reference </h4> <p>If you provide an external reference then a transaction can be refunded multiple times provided that the external reference is unique for each refund request. When a duplicate external reference is provided when attempting to refund the same transaction we return a successful response if the amount of the request is the same both times but do not process another refund, this is because we assume it to be a repeat request. If the amount is different you will get a REPEAT_REFERENCE error message.</p> <h4> Refund a Pre Auth Payment Request with Confirmations </h4> <p>The legacy refund endpoint cannot be used to refund Pre Auth Payment Requests with Confirmations. Please use the <a href="/api/payment-requests#refund">current refund endpoint</a> instead.</p> <h4> Required Parameters for one time refund </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Parameter</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">transactionId</td> <td style="text-align: left">The transaction to refund. The transaction id for a payment can be obtained from a webhook notification or from <a href="#requests-info">requests.info</a>.</td> </tr> <tr> <td style="text-align: left">amount</td> <td style="text-align: left">The amount to refund in cents</td> </tr> </tbody> </table></div> <h4> Additional required Parameter for multiple refunds </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Parameter</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">externalReference</td> <td style="text-align: left">A reference supplied by the merchant that must be unique for each refund of that transaction, can be anything you want but it must be unique.</td> </tr> </tbody> </table></div> <h4> Error Responses </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Http code</th> <th style="text-align: left">Error code</th> <th style="text-align: left">Message</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">404</td> <td style="text-align: left">3</td> <td style="text-align: left">TRANSACTION_<wbr />NOT_<wbr />FOUND</td> <td style="text-align: left">The provided transaction doesn’t exist.</td> </tr> <tr> <td style="text-align: left">400</td> <td style="text-align: left">276</td> <td style="text-align: left">ALREADY_<wbr />REFUNDED</td> <td style="text-align: left">The transaction has already been refunded.</td> </tr> <tr> <td style="text-align: left">400</td> <td style="text-align: left">277</td> <td style="text-align: left">INVALID_<wbr />AMOUNT</td> <td style="text-align: left">The refund requested is greater than the transaction amount.</td> </tr> <tr> <td style="text-align: left">400</td> <td style="text-align: left">280</td> <td style="text-align: left">REPEAT_<wbr />REFERENCE</td> <td style="text-align: left">A separate refund request for the same transaction has the same external reference, trying to refund the same transaction twice with the same external reference is not allowed. If the amount of the refund is the same we assume it is a repeat request and return 200.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">281</td> <td style="text-align: left">PARTIAL_<wbr />REFUNDS_<wbr />NOT_<wbr />ALLOWED</td> <td style="text-align: left">The asset does not support partial refunds.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left">283</td> <td style="text-align: left">INACTIVE_<wbr />ASSET</td> <td style="text-align: left">The asset is not refundable. It may have been disabled, expired, or already refunded.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left"> </td> <td style="text-align: left">REFUND_<wbr />NOT_<wbr />SUPPORTED</td> <td style="text-align: left">The asset type does not support refunds.</td> </tr> <tr> <td style="text-align: left">403</td> <td style="text-align: left"> </td> <td style="text-align: left">REFUND_<wbr />WINDOW_<wbr />EXCEEDED</td> <td style="text-align: left">The time since the payment exceeds the window of time a transaction can be refunded in.</td> </tr> </tbody> </table></div> <h2 id="webhooks"> <a href="#webhooks" aria-labelledby="webhooks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Webhooks </h2> <p>Webhook notifications are sent for significant Payment life-cycle events. The Webhook endpoint is notified by sending an HTTP POST request to the <code class="language-plaintext highlighter-rouge">notifyUrl</code> defined in the Payment Request.</p> <h3 id="life-cycle-events-that-trigger-webhooks"> <a href="#life-cycle-events-that-trigger-webhooks" aria-labelledby="life-cycle-events-that-trigger-webhooks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Life-cycle Events That Trigger Webhooks </h3> <p>The supported event types that will be notified to the Payment Requests webhook and the associated “transactionType” value that will be sent in the payload are:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Event Type</th> <th style="text-align: left">Value of “transactionType”</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">Payment Request Cancelled</td> <td style="text-align: left">CANCELLED</td> </tr> <tr> <td style="text-align: left">Payment Request Expired</td> <td style="text-align: left">EXPIRED</td> </tr> <tr> <td style="text-align: left">Transaction Completed</td> <td style="text-align: left">PURCHASE</td> </tr> <tr> <td style="text-align: left">Transaction Refunded</td> <td style="text-align: left">REFUND</td> </tr> </tbody> </table></div> <h4 id="payment-request-cancelled"> <a href="#payment-request-cancelled" aria-labelledby="payment-request-cancelled" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Payment Request Cancelled </h4> <p>A payment request can be cancelled by either calling the <a href="#requests-cancel">requests.cancel</a> or <a href="#requests-void">requests.void</a> endpoint before a request has been paid successfully. When a request has been cancelled we send a JWT that when decoded matches the <em>Payment Request Cancelled</em> example in the Decoded Webhook JWT Examples section below.</p> <h4 id="payment-request-expired"> <a href="#payment-request-expired" aria-labelledby="payment-request-expired" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Payment Request Expired </h4> <p>A payment request expires two minutes after being created if it hasn’t been cancelled, or paid. When a request has expired we send a JWT that when decoded matches the <em>Payment Request Cancelled</em> example in the Decoded Webhook JWT Examples section below with the <code class="language-plaintext highlighter-rouge">transactionType</code> set to EXPIRED.</p> <h4 id="transaction-completed"> <a href="#transaction-completed" aria-labelledby="transaction-completed" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transaction Completed </h4> <p>A transaction is considered complete when <a href="#requests-pay">requests.pay</a> is called with parameters that satisfy a payment request and the request has been paid successfully. When a transaction has been completed we send a JWT that when decoded matches the <em>Transaction Completed</em> example in the Decoded Webhook JWT Examples section below.</p> <h4 id="transaction-refunded"> <a href="#transaction-refunded" aria-labelledby="transaction-refunded" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transaction Refunded </h4> <p>A transaction can be refunded one to many times and each time a transaction has been refunded successfully we notify the webhook associated with the original payment request. A transaction can be refunded when <a href="#transactions-refund">transactions.refund</a> has been called for a partial or full refund, or when <a href="#requests-void">requests.void</a> is called for a request that has been paid. When a transaction has been refunded we send a JWT that when decoded matches the <em>Transaction Completed</em> example in the Decoded Webhook JWT Examples section below but with <code class="language-plaintext highlighter-rouge">transactionType</code> set to REFUND.</p> <h3 id="webhook-payload"> <a href="#webhook-payload" aria-labelledby="webhook-payload" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Webhook Payload </h3> <p>The body of the webhook is a JSON document with the following format:</p> <p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"${JWT}"</span><span class="w">
</span><span class="p">}</span></code></pre></div> </p> <p>The decoded JWT will contain a “transaction” property with a “transactionType” that indicates the event type. Depending on the type of event, the payload will also contain additional details about the transaction and payment request. For example:</p> <p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"transactionType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REFUND"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bec358bf-edb5-4633-a785-a95cc281d3b7"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"denomination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></div> </p> <h4 id="webhook-payload-fields"> <a href="#webhook-payload-fields" aria-labelledby="webhook-payload-fields" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Webhook Payload Fields </h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Property</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">transactionId</td> <td style="text-align: left">Id of the transaction</td> </tr> <tr> <td style="text-align: left">transactionType</td> <td style="text-align: left">Indicates which event triggered the notification message</td> </tr> <tr> <td style="text-align: left">state</td> <td style="text-align: left">Current state of the transaction</td> </tr> <tr> <td style="text-align: left">ledger</td> <td style="text-align: left">The ledger at which the authorization was processed</td> </tr> <tr> <td style="text-align: left">amount</td> <td style="text-align: left">Transaction amount in the lowest denomination available</td> </tr> <tr> <td style="text-align: left">createdAt</td> <td style="text-align: left">Timestamp at which the request was created</td> </tr> <tr> <td style="text-align: left">updatedAt</td> <td style="text-align: left">Timestamp at which the request was updated</td> </tr> <tr> <td style="text-align: left">type</td> <td style="text-align: left">The payment type used by the issuer to reconcile settlement</td> </tr> <tr> <td style="text-align: left">request</td> <td style="text-align: left">Request object, see details at <a href="#requests-info">requests.info</a></td> </tr> <tr> <td style="text-align: left">authCode</td> <td style="text-align: left">Authorization code used to settle this transaction</td> </tr> </tbody> </table></div> <h3 id="webhook-jwt-validation"> <a href="#webhook-jwt-validation" aria-labelledby="webhook-jwt-validation" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Webhook JWT Validation </h3> <p>A webhook JWT can be validated by checking the signature against the Centrapay Webhook public key:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEt+vW2fE0mLLmdzJtYrz7J9q/yEXl
gmIjCXdv3VNvYfTsaBO5PJNiaD3l9lD8PzEQu31ePsOG81mDVuo40+dgLg==
-----END PUBLIC KEY-----
</code></pre></div></div> <h3 id="decoded-webhook-jwt-examples"> <a href="#decoded-webhook-jwt-examples" aria-labelledby="decoded-webhook-jwt-examples" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Decoded Webhook JWT Examples </h3> <h4 id="transaction-completed-successfully"> <a href="#transaction-completed-successfully" aria-labelledby="transaction-completed-successfully" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transaction Completed Successfully </h4> <p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"transactionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E6ctbmgmkgZ3xnPk3BkGvb"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"transactionType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PURCHASE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ledger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"g.crypto.bitcoin.mainnet"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0FmbuirpQG4iuy6xAV9R1p"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"merchantId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"613919a417bea000290e97e3"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"externalReference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345sixseveneightnineten"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"denomination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-02T00:29:09.307Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-02T00:29:11.383Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BITCOIN"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"authCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"961241"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></div> </p> <h4 id="payment-request-cancelled-1"> <a href="#payment-request-cancelled-1" aria-labelledby="payment-request-cancelled-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Payment Request Cancelled </h4> <p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"transactionType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CANCELLED"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0FmbuirpQG4iuy6xAV9R1p"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"merchantId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"613919a417bea000290e97e3"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"613919a417bea000290e97e4"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"denomination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NZD"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></div> </p> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2021 Centrapay</p> </footer> </div> </div> <a href="#" id="search-button" class="search-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-search"></use></svg> </a> <div class="search-overlay"></div> </div> </body> </html>
